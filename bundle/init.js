"use strict";var typeTop="20px",typeLeft="0",base_cost=0,target_refund=3e3,fund_index=0,fund_data=[{best_rate:26.61,worst_rate:3.06,avg_rate:11.39,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:12.7,worst_rate:1.96,avg_rate:7.72,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:31.87,worst_rate:-4.98,avg_rate:13.37,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:46.09,worst_rate:6.8,avg_rate:22.97,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:46.76,worst_rate:2.02,avg_rate:24.25,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:31.56,worst_rate:-3.85,avg_rate:13.49,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:39.3,worst_rate:-5.65,avg_rate:22.44,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:37.92,worst_rate:4.72,avg_rate:23.36,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:27.25,worst_rate:1.29,avg_rate:14.98,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:47.64,worst_rate:3.86,avg_rate:21.78,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:58.73,worst_rate:.94,avg_rate:24.93,best_refund:0,worst_refund:0,avg_refund:0}],indexCtrl={init:function(){this.slider(),this.play(),this.pieChart(),this.showAnswer(),this.setFunds(),this.kv(),this.changeBg(),this.fromFunds(),this.playBtn(),$("#kv .slide_bar").delay(200).fadeIn("fast"),$("#weapon .btn_green").click(function(e){e.preventDefault(),window.open("https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_TX_mfund_300014&_windowLabel=T16806467151337672757923&_nffvid=%2FCTCBPortalWeb%2Fpages%2Fmf%2FmfIrRegularApply%2FmfIrRegularApplyStart.faces&firstView=true","_blank")}),$("#weapon .btn_orange").click(function(e){e.preventDefault(),window.open("http://www.ctbcbank.com/html/fileUpload/homebank/openacc.html","_blank")})},fromFunds:function(){var e=$.getUrlParam("from");1==e&&null!=e&&$(".go_formula").click()},kv:function(){var e=$(".slide_bar"),t=$(".kv"),a=$(".content"),n=$(".outer.left"),s=$(window).width(),r=$(window).height(),o=.5,i=$("#kv .bar").width();n.width(s*o),e.css("left",s*o-e.width()/2+"px"),a.width(s);var f=function(e){n.css("width",e.cw),t.css("height",e.h)},l=function(e){var t=s,a=r;return{w:t+"px",h:a+"px",cw:e*t+"px",ch:e*a+"px"}},d=function(t){var a=l(t);e.css("left",t*s-e.width()/2),c(),f(a)},c=function(){var e=$("#kv .circle_01"),t=$("#kv .circle_02"),a=$("#kv .circle_03"),n=$("#kv .circle_04"),r=e.offset().left,i=t.offset().left,f=a.offset().left,l=n.offset().left;s*o>r?e.addClass("show"):e.removeClass("show"),s*o>i?t.addClass("show"):t.removeClass("show"),s*o>f?a.addClass("show"):a.removeClass("show"),s*o>l?n.addClass("show"):n.removeClass("show")},u=function(e,t,a){return Math.max(t,Math.min(a,e))},_=function(e,t){return u((e-v)/s,0,1)},v=0,h=0,w=0,p=0,g=function(e){e.distX>e.distY&&e.distX<-e.distY||e.distX<e.distY&&e.distX>-e.distY?e.preventDefault():e.distX<e.distY&&e.distX<-e.distY||e.distX>e.distY&&(e.distX,e.distY),t.addClass("active"),v=t.offset().left,h=t.offset().top,w=s,p=n.height()},b=function(e){t.hasClass("active")&&(o=_(e.pageX,e.pageY),d(o))},m=function(){t.removeClass("active")};e.on("movestart",g),e.on("move",b),e.on("moveend",m),e.on("touchmove",function(e){e.preventDefault()}),$(window).on("resize",function(e){s=$(window).width(),r=$(window).height(),a.width(s),i=$("#kv .bar").width(),d(o)})},changeBg:function(){var e=$(".content"),t=$(".content.left"),a=$(".content.right"),n=$("#kv .change_theme li"),s=$("#kv .active"),r=function(n){e.fadeOut("normal",function(){t.css("background","url(images/theme"+n+"_01.jpg) no-repeat center top").css("backgroundSize","cover"),a.css("background","url(images/theme"+n+"_02.jpg) no-repeat center top").css("backgroundSize","cover")}).delay(200).fadeIn("fast")};n.click(function(e){e.preventDefault();var t=$(this).index();typeTop=$(this).data("top"),typeLeft=$(this).data("left"),$(this).hasClass("active")||(n.removeClass("active"),menuCtrl.chkDevice()?(s.css("top","0px"),s.stop().animate({left:typeLeft},500)):(s.css("left","0"),s.stop().animate({top:typeTop},500)),$(this).addClass("active"),r(t))}).eq(0).click(),$(window).resize(function(){menuCtrl.chkDevice()?(s.css("top","0px"),s.css("left",typeLeft)):(s.css("top",typeTop),s.css("left","0"))})},playBtn:function(){var e=$(".go_formula");$(window).scrollTop()>90?e.addClass("show"):e.removeClass("show"),$(window).scroll(function(){$(window).scrollTop()>90?e.addClass("show"):e.removeClass("show")})},play:function(){var e=this,t=0;$("#top .indexPage li:eq(1), .go_formula").click(function(a){a.preventDefault();var n=menuCtrl.chkDevice()?$("#analysis .mb").height():0;t=e.caloffset("#analysis")+n,menuCtrl.scrollPage(t)})},setFunds:function(){var e=$("#analysis .select_wrapper");e.change(function(){var t=e.find(":selected").val();$("#result .inline li.find_item").hide(),$("."+t).show()});var t=$("#analysis");t.change(function(){t.find(":selected").val()})},showAnswer:function(){var e=this,t=$("#analysis .btn_wrapper .btn_green"),a=$("#analysis .btn_wrapper .btn_white"),n=0;t.click(function(a){a.preventDefault();var s=menuCtrl.chkDevice()?$("#analysis .mb").height():0;if(t.hasClass("show"))return n=e.caloffset("#analysis")+s,menuCtrl.scrollPage(n),void $("#result").delay(300).slideUp({duration:500,complete:function(){t.removeClass("show")}});$("#result").slideDown({duration:750,complete:function(){t.addClass("show");var a=e.caloffset("#result")+s;menuCtrl.scrollPage(a)}})}),a.click(function(e){e.preventDefault(),trackWaitJump("","fund_list.html")})},slider:function(){var e=$("#slider"),t=$(".silder_wrapper font"),a=$("#analysis .money"),n=function(e,t){return Math.round(e/(36*(100+t)/100))};e.slider({range:"min",value:target_refund,min:0,max:3e4,step:1,create:function(){t.text($(this).slider("value")),target_refund=$(this).slider("value"),base_cost=n(target_refund,fund_data[fund_index].avg_rate),a.text(base_cost)},slide:function(e,s){t.text(s.value),target_refund=$(this).slider("value"),base_cost=n(target_refund,fund_data[fund_index].avg_rate),a.text(base_cost)},change:function(e,s){t.text(s.value),target_refund=$(this).slider("value"),base_cost=n(target_refund,fund_data[fund_index].avg_rate),a.text(base_cost)}})},pieChart:function(){var e=$("#control .go_right"),t=$("#control .pie1, #control .pie2, #control .pie3");window.sr=ScrollReveal({duration:0,origin:"left",afterReveal:function(e){$.each(t,function(e,t){$(t).addClass("instage")})}}),sr.reveal(e)},caloffset:function(e){return $(e).offset().top-parseInt($(e).css("padding-top").replace("px",""))}};$(function(){indexCtrl.init()});