"use strict";!function(e){e.preload=function(){for(var t=[],a=arguments.length;a--;)t.push(e("<img />").attr("src",arguments[a]))}}(jQuery);var typeTop="20px",typeLeft="0",interest_fund=$("#analysis .select_wrapper:eq(0)"),select_fund=$("#analysis .select_wrapper:eq(1)"),select_option={shopping:['<option value="0">摩根士丹利美國優勢基金(累積)(美元)</option>','<option value="4">富達全球消費行業基金(再投資)(歐元)</option>'],digital:['<option value="0">摩根士丹利美國優勢基金(累積)(美元)</option>','<option value="1">美盛凱利美國大型公司成長基金(累積)(美元)</option>','<option value="9">百達－數位科技基金(累積)(美元)</option>','<option value="10">富蘭克林高科技基金(再投資)(美元)(本基金配息來源可能為本金)</option>'],healthy:['<option value="1">美盛凱利美國大型公司成長基金(累積)(美元)</option>','<option value="2">新加坡大華全球保健基金(累積)(美元)</option>'],reality:['<option value="3">NN(L)食品飲料基金(累積)(美元)(本基金配息來源可能為本金)</option>','<option value="5">貝萊德亞洲老虎債券基金(累積)(美元)(本基金有相當比重投資於非投資等級之高風險債券)</option>'],excited:['<option value="5">貝萊德亞洲老虎債券基金(累積)(美元)(本基金有相當比重投資於非投資等級之高風險債券)</option>','<option value="6">景順環球高收益債券基金(半年再投資)(美元)(本基金主要係投資於非投資等級之高風險債券)</option>','<option value="7">貝萊德環球高收益債券基金(累積)(美元)(本基金主要係投資於非投資等級之高風險債券)</option>','<option value="8">貝萊德環球企業債券基金 A2 美元</option>']},base_cost=0,target_refund=0,fund_index=0,fund_rate=0,fund_data=[{best_rate:26.61,worst_rate:3.06,avg_rate:11.39,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:12.7,worst_rate:1.96,avg_rate:7.72,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:31.87,worst_rate:-4.98,avg_rate:13.37,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:46.09,worst_rate:6.8,avg_rate:22.97,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:46.76,worst_rate:2.02,avg_rate:24.25,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:31.56,worst_rate:-3.85,avg_rate:13.49,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:39.3,worst_rate:-5.65,avg_rate:22.44,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:37.92,worst_rate:4.72,avg_rate:23.36,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:27.25,worst_rate:1.29,avg_rate:14.98,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:47.64,worst_rate:3.86,avg_rate:21.78,best_refund:0,worst_refund:0,avg_refund:0},{best_rate:58.73,worst_rate:.94,avg_rate:24.93,best_refund:0,worst_refund:0,avg_refund:0}],indexCtrl={init:function(){this.slider(),this.play(),this.pieChart(),this.showAnswer(),this.setFunds(),this.kv(),this.changeBg(),this.fromFunds(),this.playBtn(),$("#kv .slide_bar").fadeIn("slow"),$("#weapon .btn_green").click(function(e){e.preventDefault(),gaclick("fund"),window.open("https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_TX_mfund_300014&_windowLabel=T16806467151337672757923&_nffvid=%2FCTCBPortalWeb%2Fpages%2Fmf%2FmfIrRegularApply%2FmfIrRegularApplyStart.faces&firstView=true","_blank")}),$("#weapon .btn_orange").click(function(e){e.preventDefault(),gaclick("open"),window.open("http://www.ctbcbank.com/html/fileUpload/homebank/openacc.html","_blank")}),$(window).on("load",function(){$.preload("images/theme2_01.jpg","images/theme2_02.jpg","images/theme3_01.jpg","images/theme3_02.jpg","images/theme4_01.jpg","images/theme4_02.jpg","images/theme1_01_pad.jpg","images/theme1_02_pad.jpg","images/theme2_01_pad.jpg","images/theme2_02_pad.jpg","images/theme3_01_pad.jpg","images/theme3_02_pad.jpg","images/theme4_01_pad.jpg","images/theme4_02_pad.jpg","images/theme1_01_m.jpg","images/theme1_02_m.jpg","images/theme2_01_m.jpg","images/theme2_02_m.jpg","images/theme3_01_m.jpg","images/theme3_02_m.jpg","images/theme4_01_m.jpg","images/theme4_02_m.jpg")})},fromFunds:function(){var e=$.getUrlParam("from");1==e&&null!=e&&$(".go_formula").click()},kv:function(){var e=$(".slide_bar"),t=$(".kv"),a=$(".content"),n=$(".outer.left"),s=$(window).width(),i=$(window).height(),o=.5;$("#kv .bar").width();n.width(s*o),e.css("left",s*o-e.width()/2+"px"),a.width(s);var r=function(a){var o=function(e){return{w:s+"px",h:i+"px",cw:e*s+"px",ch:e*i+"px"}}(a);e.css("left",a*s-e.width()/2),l(),function(e){n.css("width",e.cw),t.css("height",e.h)}(o)},l=function(){var e=$("#kv .circle_01"),t=$("#kv .circle_02"),a=$("#kv .circle_03"),n=$("#kv .circle_04"),i=e.offset().left,r=t.offset().left,l=a.offset().left,d=n.offset().left;s*o>i?e.addClass("show"):e.removeClass("show"),s*o>r?t.addClass("show"):t.removeClass("show"),s*o>l?a.addClass("show"):a.removeClass("show"),s*o>d?n.addClass("show"):n.removeClass("show")},d=function(e,t){return function(e,t,a){return Math.max(t,Math.min(a,e))}((e-f)/s,0,1)},f=0;e.on("movestart",function(e){e.distX>e.distY&&e.distX<-e.distY||e.distX<e.distY&&e.distX>-e.distY?e.preventDefault():e.distX<e.distY&&e.distX<-e.distY||e.distX>e.distY&&(e.distX,e.distY),t.addClass("active"),f=t.offset().left,t.offset().top,s,n.height()}),e.on("move",function(e){t.hasClass("active")&&(o=d(e.pageX,e.pageY),r(o))}),e.on("moveend",function(){t.removeClass("active")}),e.on("touchmove",function(e){e.preventDefault()}),$(window).on("resize",function(e){s=$(window).width(),i=$(window).height(),a.width(s),$("#kv .bar").width(),r(o)})},changeBg:function(){var e=$(".content"),t=$(".content.left"),a=$(".content.right"),n=$("#kv .change_theme li"),s=$("#kv .active");n.click(function(i){i.preventDefault();var o=$(this).data("class");typeTop=$(this).data("top"),typeLeft=$(this).data("left"),$(this).hasClass("active")||(n.removeClass("active"),menuCtrl.chkDevice()?s.css("top","0px").stop().animate({left:typeLeft},500):s.css("left","0").stop().animate({top:typeTop},500),$(this).addClass("active"),function(n){e.stop().fadeOut("fast",function(){t.removeClass("car wedding school son").addClass(n),a.removeClass("car wedding school son").addClass(n)}).fadeIn("slow")}(o))}).eq(0).click(),$(window).resize(function(){menuCtrl.chkDevice()?s.css("top","0px").css("left",typeLeft):s.css("top",typeTop).css("left","0")})},playBtn:function(){var e=$(".go_formula");$(window).scrollTop()>90?e.addClass("show"):e.removeClass("show"),$(window).scroll(function(){$(window).scrollTop()>90?e.addClass("show"):e.removeClass("show")})},play:function(){var e=this,t=0;$("#top .indexPage li:eq(1), .go_formula").click(function(a){a.preventDefault();var n=menuCtrl.chkDevice()?$("#analysis .mb").height():0;t=e.caloffset("#analysis")+n,menuCtrl.scrollPage(t)})},setFunds:function(){interest_fund.change(function(){var e=interest_fund.find(":selected").val();select_fund.find("select").empty(),select_fund.find("select").append('<option value="999">請選擇基金</option>'),$.each(select_option[e],function(e,t){select_fund.find("select").append(t)}),999!=e?select_fund.parents("li").show():select_fund.parents("li").hide()}),select_fund.change(function(){var e=select_fund.find(":selected").val();fund_index=e,fund_rate=fund_data[e].avg_rate})},showAnswer:function(){var e=this,t=$("#analysis .btn_wrapper .btn_green"),a=$("#analysis .btn_wrapper .btn_white"),n=$("#analysis .analysis_result");t.click(function(a){if(a.preventDefault(),999!=interest_fund.find(":selected").val())if(999!=select_fund.find(":selected").val())if(0!=$("#slider").slider("value")){var s=0,i=0;if(t.hasClass("show"))return s=menuCtrl.chkDevice()?$("#analysis .mb").height():0,i=e.caloffset("#analysis")+s,void n.slideUp({duration:750,complete:function(){t.removeClass("show"),interest_fund.find("select").val(999),select_fund.find("select").val(999),select_fund.parents("li").hide(),$("#slider").slider("value",0),menuCtrl.scrollPage(i)}});n.slideDown({duration:750,complete:function(){t.addClass("show")}})}else alert("請選擇希望達成目標");else alert("請選擇基金");else alert("請選擇興趣")}),a.click(function(e){e.preventDefault(),trackWaitJump("","fund_list.html")})},slider:function(){var e=$("#slider"),t=$(".silder_wrapper font"),a=$("#analysis .money"),n=function(e,t){return Math.round(e/(36*(100+t)/100))};e.slider({range:"min",value:target_refund,min:0,max:3e4,step:1,create:function(){t.text($(this).slider("value")),target_refund=$(this).slider("value"),base_cost=n(target_refund,fund_rate),a.text(base_cost)},slide:function(e,s){t.text(s.value),target_refund=$(this).slider("value"),base_cost=n(target_refund,fund_rate),a.text(base_cost)},change:function(e,s){t.text(s.value),target_refund=$(this).slider("value"),base_cost=n(target_refund,fund_rate),a.text(base_cost)}})},pieChart:function(){var e=$("#control .go_right"),t=$("#control .pie1, #control .pie2, #control .pie3");window.sr=ScrollReveal({duration:0,origin:"left",afterReveal:function(e){$.each(t,function(e,t){$(t).addClass("instage")})}}),sr.reveal(e)},caloffset:function(e){return $(e).offset().top-parseInt($(e).css("padding-top").replace("px",""))}};$(function(){indexCtrl.init()});